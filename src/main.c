#include "disasm.h"

int main(void)
{
    const unsigned char instructions[] = {
        0x55, // push rbp
        0x48, 0x89, 0xe5, // mov rbp, rsp
        0x48, 0x83, 0xec, 0x10, // sub rsp, 0x10
        0xe8, 0xe8, 0xff, 0xff, 0xff, // call 1139
        0x89, 0x45, 0xfc, // mov dword ptr [rbp-0x4], eax
        0x48, 0x89, 0x30, // mov qword ptr [rax], rsi 
        0x8b, 0x45, 0xfc, // mov eax, dword ptr [rbp-0x4]
        0x48, 0x8d, 0x15, 0xa6, 0x0e, 0x00, 0x00, // lea rdx, [rip+0xea6]
        0x89, 0xc6, // mov esi, eax
        0x48, 0x89, 0xd7, // mov rdi, rdx
        0x66, 0x89, 0xf8, // mov ax, di
        0xb8, 0x00, 0x00, 0x00, 0x00, // mov eax, 0x0
        0xe8, 0xc3, 0xfe, 0xff, 0xff, // call 1030

        0xb8, 0x00, 0x00, 0x00, 0x00, // mov eax, 0x0

        0x48, 0x89, 0x3c, 0x84, // mov qword ptr [rsp+rax*4], rdi
        0x67, 0x89, 0x3C, 0x90, // mov dword ptr[eax+edx*4], edi
        0x67, 0x48, 0x89, 0x3C, 0x90, // mov qword ptr [eax+edx*4], rdi
        0x67, 0x66, 0x89, 0x3C, 0x90, // mov word ptr [eax+edx*4], di
        0x89, 0x3c, 0x90, // mov dword ptr [rax+rdx*4], edi
        0x66, 0x89, 0x3c, 0x90, // mov word ptr [rax+rdx*4], di

        0x48, 0x89, 0x35, 0x10, 0x00, 0x00, 0x00, // mov qword ptr [rip + 0x10], rsi
        0x67, 0x48, 0x89, 0x35, 0x10, 0x00, 0x00, 0x00, // mov qword ptr [eip + 0x10], rsi
        0x89, 0x35, 0x10, 0x00, 0x00, 0x00, // mov dword ptr [rip + 0x10], esi
        0x66, 0x89, 0x35, 0x10, 0x00, 0x00, 0x00, // mov word ptr [rip + 0x10], si

        0x89, 0x06, // mov dword ptr [rsi], eax
        0x48, 0x89, 0x06, // mov qword ptr [rsi], rax
        0x66, 0x89, 0x06, // mov word ptr [rsi], ax
        0x67, 0x89, 0x06, // mov dword ptr [esi], eax
        0x67, 0x48, 0x89, 0x06, // mov qword ptr [esi], rax
        0x67, 0x66, 0x89, 0x06, // mov word ptr [esi], ax

        0x48, 0x89, 0x04, 0x25, 0x10, 0x00, 0x00, 0x00, // mov qword ptr ds:0x10,rax
        0x89, 0x04, 0x25, 0x10, 0x00, 0x00, 0x00, // mov dword ptr ds:0x10,eax 
        0x66, 0x89, 0x04, 0x25, 0x10, 0x00, 0x00, 0x00, // mov word ptr ds:0x10,ax

        0x48, 0x89, 0x04, 0x85, 0x10, 0x00, 0x00, 0x00, // mov qword ptr [rax*4+0x10],rax
        0x89, 0x04, 0x85, 0x10, 0x00, 0x00, 0x00, // mov dword ptr [rax*4+0x10],rax
        0x66, 0x89, 0x04, 0x85, 0x10, 0x00, 0x00, 0x00, // mov word ptr [rax*4+0x10],ax

        0x58, // pop rax
        0x5b, // pop rbx
        0x59, // pop rcx
        0x5a, // pop rdx
        0x41, 0x58, // pop r8
        0x41, 0x59, // pop r9
        0x41, 0x5A, // pop r10
        0x41, 0x5B, // pop r11
        0x41, 0x5C, // pop r12
        0x41, 0x5D, // pop r13
        0x41, 0x5E, // pop r14
        0x41, 0x5F, // pop r15
        
        0x1F, // pop ds
        0x07, // pop es
        0x17, // pop ss
        0x0f, 0xa1, // pop fs
        0x0f, 0xa9, // pop gs

        0x67, 0x8f, 0x00, // pop qword ptr [eax]
        0x8f, 0x01, // pop qword ptr [rcx]

        0x48, 0x89, 0x70, 0x10, // mov qword ptr [rax+0x10],rsi 
        0x89, 0x70, 0x10, // mov dword ptr [rax+0x10],esi 
        0x66, 0x89, 0x70, 0x10, // mov word ptr [rax+0x10],si 
        
        0x48, 0x89, 0x44, 0xB0, 0x10, // mov qword ptr [rax+rsi*4+0x10],rax 
        0x89, 0x44, 0xB0, 0x10, // mov dword ptr [rax+rsi*4+0x10],eax 
        0x66, 0x89, 0x44, 0xB0, 0x10, // mov word ptr [rax+rsi*4+0x10],ax 


        0xc9, // leave
        0xc3 // ret
    };

    disasm(instructions, sizeof(instructions));
    return 0;
}
